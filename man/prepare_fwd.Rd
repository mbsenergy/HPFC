% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wrappers.R
\name{prepare_fwd}
\alias{prepare_fwd}
\title{Prepare Forward Curves for Forecasting}
\usage{
prepare_fwd(
  fwd_pwr_code = NULL,
  fwd_gas_code = NULL,
  start_date,
  end_date,
  model_type = "PWR",
  forecast_source = "FWD",
  archive,
  manual_pwr = NULL,
  manual_gas = NULL
)
}
\arguments{
\item{fwd_pwr_code}{Character vector. Power forward product code(s).}

\item{fwd_gas_code}{Character vector. Gas forward product code(s).}

\item{start_date}{Date. Forecast start date.}

\item{end_date}{Date. Forecast end date.}

\item{model_type}{Character. Either \code{'PWR'} (default) or \code{'GAS'}, determining which forward products to retrieve.}

\item{forecast_source}{Character. Forward price source, \code{'FWD'} (default) or \code{'DAM'}.}

\item{archive}{Character. Path where output files are saved.}

\item{manual_pwr}{Optional \code{data.table}. Manually supplied forward power data.}

\item{manual_gas}{Optional \code{data.table}. Manually supplied forward gas data.}
}
\value{
A named list containing:
\describe{
\item{ENV_FWD}{A list with calendar, RICs, forward data, and metadata for downstream modeling.}
}
}
\description{
Prepares forward market data for power and gas products to be used in forecasting models. Supports both
automated data retrieval and manual input. Outputs are stored and returned for downstream forecasting workflows.
}
\details{
If \code{manual_pwr} and \code{manual_gas} are both provided, the function uses them instead of retrieving raw data.
Otherwise, it constructs a list of required RICs and fetches the forward curves from internal datasets and APIs.
It filters the latest available value for each RIC and ensures coverage for the forecast horizon.

The function saves three files to the specified \code{archive} path (unless \code{LST_PARAMS$archive == 'NO'}):
\itemize{
\item \code{ENV_FWD.rds}: list containing metadata and raw data
\item \code{dt_fwds.rds}: processed forward curve data
\item \code{dt_fwds.csv}: forward data in CSV format
}
}
